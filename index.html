<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ROI Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .value-dark {
            color: #e5e7eb;
        }

        .value-light {
            color: #111827;
        }

        .accent-dark {
            color: #34d399;
        }

        .accent-light {
            color: #047857;
        }

        body.light {
            background: #ffffff;
            color: #0a0a0a;
        }

        body.light .card {
            background: #ffffff;
            border-color: #e5e7eb;
        }

        body.light .muted {
            color: #374151;
        }

        body.light .label {
            color: #111827;
        }

        body.light .divider {
            border-color: #e5e7eb;
        }

        body.light .toggle {
            border-color: #111827;
            color: #111827;
            background: #ffffff;
        }

        body.light .export {
            border-color: #111827;
            color: #111827;
            background: #ffffff;
        }

        body.light .value-dark {
            color: #111827;
        }

        body.light .accent-dark {
            color: #047857;
        }

        #exportArea {
            width: 100%;
            margin: 0 auto;
        }

        body.exporting #exportArea {
            width: 794px;
            min-height: 1123px;
            margin: 0 auto;
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 7px;
            border-radius: 9999px;
            background: linear-gradient(90deg, #34d399 0%, #34d399 50%, #3f3f46 50%, #3f3f46 100%);
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 9999px;
            background: #34d399;
            border: none;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 9999px;
            background: #34d399;
            border: none;
        }

        input[type="range"]::-moz-range-track {
            height: 7px;
            border-radius: 9999px;
            background: transparent;
        }
    </style>
</head>

<body class="min-h-screen bg-zinc-950 text-zinc-100">
    <div id="exportArea">
        <div class="mx-auto max-w-6xl px-6 py-6 space-y-5">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-semibold tracking-tight">ROI Calculator</h1>
                    <p class="text-base text-zinc-400 muted">Live projection</p>
                </div>
                <div class="flex items-center gap-3">
                    <button id="themeToggle" class="toggle rounded-lg border border-zinc-700 bg-zinc-900 p-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 18h6" />
                            <path d="M10 22h4" />
                            <path d="M12 2a7 7 0 0 0-4 12c.6.6 1 1.7 1 3h6c0-1.3.4-2.4 1-3a7 7 0 0 0-4-12z" />
                        </svg>
                    </button>
                    <button id="exportPdf"
                        class="export rounded-lg border border-emerald-400/40 bg-emerald-500/10 px-4 py-2.5 text-base font-medium text-emerald-200">Export
                        PDF</button>
                </div>
            </div>

            <div class="mt-4 space-y-4">
                <div class="space-y-4">
                    <div class="space-y-2">
                        <div class="space-y-3" data-metric="serviceCost">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="serviceCostValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="serviceCost" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="emails">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="emailsValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="emails" type="range" class="h-1.5 w-full accent-emerald-500" data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="replyRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="replyRateValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="replyRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="interestedRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="interestedRateValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="interestedRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="bookingRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="bookingRateValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="bookingRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="showRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="showRateValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="showRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="closeRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="closeRateValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="closeRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="dealSize">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <span id="dealSizeValue" class="value-dark" data-metric-value></span>
                            </div>
                            <p class="text-xs text-zinc-400 muted" data-metric-description></p>
                            <input id="dealSize" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="card rounded-2xl border border-zinc-800 bg-zinc-900/50 p-6">
                        <h2 class="text-base font-semibold uppercase tracking-wide muted text-zinc-300">Projected
                            Pipeline
                        </h2>
                        <div class="mt-3 divide-y divide-zinc-800 divider text-base">
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Total Replies</span>
                                <span id="replies" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Interested Leads</span>
                                <span id="interested" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Bookings</span>
                                <span id="bookings" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Shows</span>
                                <span id="shows" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Closes</span>
                                <span id="closes" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Total Revenue</span>
                                <span id="revenue" class="accent-dark font-semibold"></span>
                            </div>
                        </div>
                    </div>

                    <div class="card rounded-2xl border border-emerald-500/30 bg-emerald-500/10 p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="text-xs uppercase muted text-emerald-200/80">Net Return</div>
                                <div id="netReturn" class="text-3xl font-semibold accent-dark"></div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs uppercase muted text-emerald-200/80">ROI Multiple</div>
                                <div id="roiMultiple" class="text-3xl font-semibold accent-dark"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script>
            const METRICS = {
                serviceCost: {
                    label: "Service Cost ($)",
                    description: "Monthly service fee for the campaign.",
                    min: 2500,
                    max: 50000,
                    step: 500,
                    default: 15000,
                    format: (value) => formatCurrency(value)
                },
                emails: {
                    label: "Total Emails Sent",
                    description: "Total outbound emails sent in the period.",
                    min: 10000,
                    max: 500000,
                    step: 5000,
                    default: 100000,
                    format: (value) => value.toLocaleString()
                },
                replyRate: {
                    label: "Reply Rate (%)",
                    description: "Percent of emails that get a response.",
                    min: 0.1,
                    max: 5,
                    step: 0.05,
                    default: 0.75,
                    format: (value) => `${value.toFixed(2)}%`
                },
                interestedRate: {
                    label: "Interested Lead Rate (%)",
                    description: "Replies that show buying intent.",
                    min: 5,
                    max: 40,
                    step: 1,
                    default: 15,
                    format: (value) => `${Math.round(value)}%`
                },
                bookingRate: {
                    label: "Lead-to-Booking Rate (%)",
                    description: "Interested leads that book a meeting.",
                    min: 10,
                    max: 80,
                    step: 5,
                    default: 50,
                    format: (value) => `${Math.round(value)}%`
                },
                showRate: {
                    label: "Meeting Show Rate (%)",
                    description: "Booked meetings that show up.",
                    min: 40,
                    max: 90,
                    step: 5,
                    default: 80,
                    format: (value) => `${Math.round(value)}%`
                },
                closeRate: {
                    label: "Close Rate (%)",
                    description: "Meetings that convert to customers.",
                    min: 5,
                    max: 40,
                    step: 5,
                    default: 25,
                    format: (value) => `${Math.round(value)}%`
                },
                dealSize: {
                    label: "Average Deal Size ($)",
                    description: "Average revenue per closed deal.",
                    min: 2500,
                    max: 500000,
                    step: 2500,
                    default: 250000,
                    format: (value) => formatCurrency(value)
                }
            };

            function formatCurrency(value) {
                return new Intl.NumberFormat("en-US", {
                    style: "currency",
                    currency: "USD",
                    maximumFractionDigits: 0
                }).format(value);
            }

            function roundHundreds(value) {
                return Math.round(value / 100) * 100;
            }

            const defaults = Object.fromEntries(
                Object.entries(METRICS).map(([key, config]) => [key, config.default])
            );

            const state = { ...defaults };

            const elements = {};
            const readouts = {};
            const metricBlocks = document.querySelectorAll("[data-metric]");

            metricBlocks.forEach((block) => {
                const key = block.dataset.metric;
                const config = METRICS[key];
                if (!config) return;

                const labelEl = block.querySelector("[data-metric-label]");
                const descriptionEl = block.querySelector("[data-metric-description]");
                const valueEl = block.querySelector("[data-metric-value]");
                const inputEl = block.querySelector("[data-metric-input]");

                if (labelEl) labelEl.textContent = config.label;
                if (descriptionEl) descriptionEl.textContent = config.description;
                if (inputEl) {
                    inputEl.min = config.min;
                    inputEl.max = config.max;
                    inputEl.step = config.step;
                    inputEl.value = config.default;
                }

                if (inputEl) elements[key] = inputEl;
                if (valueEl) readouts[key] = valueEl;
            });

            const outputs = {
                replies: document.getElementById("replies"),
                interested: document.getElementById("interested"),
                bookings: document.getElementById("bookings"),
                shows: document.getElementById("shows"),
                closes: document.getElementById("closes"),
                revenue: document.getElementById("revenue"),
                netReturn: document.getElementById("netReturn"),
                roiMultiple: document.getElementById("roiMultiple")
            };

            const setRangeFill = (input) => {
                const min = Number(input.min);
                const max = Number(input.max);
                const val = Number(input.value);
                const pct = ((val - min) / (max - min)) * 100;
                input.style.background = `linear-gradient(90deg, #34d399 0%, #34d399 ${pct}%, #3f3f46 ${pct}%, #3f3f46 100%)`;
            };

            const setReadouts = () => {
                Object.keys(METRICS).forEach((key) => {
                    const formatter = METRICS[key].format;
                    if (readouts[key]) {
                        readouts[key].textContent = formatter ? formatter(state[key]) : state[key];
                    }
                });
            };

            const calculate = () => {
                const replies = Math.round(state.emails * (state.replyRate / 100));
                const interested = Math.round(replies * (state.interestedRate / 100));
                const bookings = Math.round(interested * (state.bookingRate / 100));
                const shows = Math.round(bookings * (state.showRate / 100));
                const closes = Math.floor(shows * (state.closeRate / 100));
                const revenue = roundHundreds(closes * state.dealSize);
                const netReturn = roundHundreds(revenue - state.serviceCost);
                const roiMultiple = state.serviceCost === 0 ? 0 : revenue / state.serviceCost;

                outputs.replies.textContent = replies.toLocaleString();
                outputs.interested.textContent = interested.toLocaleString();
                outputs.bookings.textContent = bookings.toLocaleString();
                outputs.shows.textContent = shows.toLocaleString();
                outputs.closes.textContent = closes.toLocaleString();
                outputs.revenue.textContent = formatCurrency(revenue);
                outputs.netReturn.textContent = formatCurrency(netReturn);
                outputs.roiMultiple.textContent = `${roiMultiple.toFixed(1)}Ã—`;
            };

            Object.keys(elements).forEach((key) => {
                elements[key].value = state[key];
                setRangeFill(elements[key]);
                elements[key].addEventListener("input", (event) => {
                    state[key] = Number(event.target.value);
                    setRangeFill(event.target);
                    setReadouts();
                    calculate();
                });
            });

            setReadouts();
            calculate();

            const exportButton = document.getElementById("exportPdf");
            exportButton.addEventListener("click", async () => {
                const { jsPDF } = window.jspdf;

                const root = document.documentElement;
                const exportArea = document.getElementById("exportArea");
                const isLight = document.body.classList.contains("light");
                const backgroundColor = isLight ? "#ffffff" : "#0b0b0c";

                const themeToggle = document.getElementById("themeToggle");
                const exportPdf = document.getElementById("exportPdf");
                const prevThemeDisplay = themeToggle.style.display;
                const prevExportDisplay = exportPdf.style.display;
                const prevOverflow = root.style.overflow;
                root.style.overflow = "visible";
                document.body.classList.add("exporting");
                themeToggle.style.display = "none";
                exportPdf.style.display = "none";

                const canvas = await html2canvas(exportArea, {
                    backgroundColor,
                    scale: 2,
                    scrollX: 0,
                    scrollY: 0,
                    windowWidth: exportArea.scrollWidth,
                    windowHeight: exportArea.scrollHeight,
                });

                themeToggle.style.display = prevThemeDisplay;
                exportPdf.style.display = prevExportDisplay;
                document.body.classList.remove("exporting");
                root.style.overflow = prevOverflow;

                const pdf = new jsPDF("p", "pt", "a4");
                const pageWidth = pdf.internal.pageSize.getWidth();
                const imgWidth = pageWidth;
                const imgHeight = canvas.height * pageWidth / canvas.width;
                pdf.addImage(canvas.toDataURL("image/png"), "PNG", 0, 0, imgWidth, imgHeight);

                pdf.save("roi-calculator.pdf");
            });

            const themeToggle = document.getElementById("themeToggle");
            themeToggle.addEventListener("click", () => {
                document.body.classList.toggle("light");
            });
        </script>
</body>

</html>