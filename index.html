<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ProfitPath Growth Partners</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .value-dark {
            color: #e5e7eb;
        }

        .value-light {
            color: #111827;
        }

        .accent-dark {
            color: #34d399;
        }

        .accent-light {
            color: #047857;
        }

        body.light {
            background: #ffffff;
            color: #0a0a0a;
        }

        body.light .card {
            background: #ffffff;
            border-color: #e5e7eb;
        }

        body.light .muted {
            color: #374151;
        }

        body.light .label {
            color: #111827;
        }

        body.light .divider {
            border-color: #e5e7eb;
        }

        body.light .toggle {
            border-color: #111827;
            color: #111827;
            background: #ffffff;
        }

        body.light .export {
            border-color: #111827;
            color: #111827;
            background: #ffffff;
        }

        body.light .value-dark {
            color: #111827;
        }

        body.light .accent-dark {
            color: #047857;
        }

        #exportArea {
            width: 100%;
            margin: 0 auto;
        }

        body.exporting #exportArea {
            width: 794px;
            min-height: 1123px;
            margin: 0 auto;
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 7px;
            border-radius: 9999px;
            background: linear-gradient(90deg, #34d399 0%, #34d399 50%, #3f3f46 50%, #3f3f46 100%);
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 9999px;
            background: #34d399;
            border: none;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 9999px;
            background: #34d399;
            border: none;
        }

        input[type="range"]::-moz-range-track {
            height: 7px;
            border-radius: 9999px;
            background: transparent;
        }
    </style>
</head>

<body class="min-h-screen bg-zinc-950 text-zinc-100">
    <div id="exportArea">
        <div class="mx-auto max-w-6xl px-6 py-6 space-y-5">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-semibold tracking-tight">ProfitPath Growth Partners</h1>
                    <p class="text-base text-zinc-400 muted">Cold Email ROI Calculator</p>
                </div>
                <div class="flex items-center gap-3">
                    <button id="themeToggle" class="toggle rounded-lg border border-zinc-700 bg-zinc-900 p-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 18h6" />
                            <path d="M10 22h4" />
                            <path d="M12 2a7 7 0 0 0-4 12c.6.6 1 1.7 1 3h6c0-1.3.4-2.4 1-3a7 7 0 0 0-4-12z" />
                        </svg>
                    </button>
                    <button id="exportPdf"
                        class="export rounded-lg border border-emerald-400/40 bg-emerald-500/10 px-4 py-2.5 text-base font-medium text-emerald-200">Export
                        PDF</button>
                </div>
            </div>

            <div class="mt-4 space-y-4">
                <div class="flex items-center gap-2 text-sm">
                    <button type="button" data-preset="sbm"
                        class="preset-toggle rounded-full border border-zinc-700 bg-zinc-900 px-3 py-1 text-zinc-200">
                        SBM
                    </button>
                    <button type="button" data-preset="enterprise"
                        class="preset-toggle rounded-full border border-zinc-700 bg-zinc-900 px-3 py-1 text-zinc-200">
                        Enterprise
                    </button>
                </div>
                <div class="space-y-4">
                    <div class="space-y-2">
                        <div class="space-y-3" data-metric="serviceCost">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="serviceCostValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="serviceCost" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="emails">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="emailsValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="emails" type="range" class="h-1.5 w-full accent-emerald-500" data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="replyRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="replyRateValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="replyRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="interestedRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="interestedRateValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="interestedRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="bookingRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="bookingRateValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="bookingRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="showRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="showRateValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="showRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="closeRate">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="closeRateValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="closeRate" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>

                        <div class="space-y-3" data-metric="dealSize">
                            <div class="flex items-center justify-between text-sm">
                                <span class="label text-zinc-200" data-metric-label></span>
                                <input id="dealSizeValue" type="number"
                                    class="w-32 rounded-md border border-zinc-700 bg-zinc-900/60 px-2 py-1 text-right text-zinc-100"
                                    data-metric-number />
                            </div>
                            <input id="dealSize" type="range" class="h-1.5 w-full accent-emerald-500"
                                data-metric-input />
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="card rounded-2xl border border-zinc-800 bg-zinc-900/50 p-6">
                        <h2 class="text-base font-semibold uppercase tracking-wide muted text-zinc-300">Projected
                            Pipeline & Revenue Impact
                        </h2>
                        <div class="mt-3 divide-y divide-zinc-800 divider text-base">
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Real Replies</span>
                                <span id="replies" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Interested Leads</span>
                                <span id="interested" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Booked Meetings</span>
                                <span id="bookings" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Live Meetings</span>
                                <span id="shows" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Deals Won</span>
                                <span id="closes" class="value-dark"></span>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <span class="muted text-zinc-400">Total Revenue</span>
                                <span id="revenue" class="accent-dark font-semibold"></span>
                            </div>
                        </div>
                    </div>

                    <div class="card hidden rounded-2xl border border-emerald-500/30 bg-emerald-500/10 p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="text-xs uppercase muted text-emerald-200/80">Net Return</div>
                                <div id="netReturn" class="text-3xl font-semibold accent-dark"></div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs uppercase muted text-emerald-200/80">ROI Multiple</div>
                                <div id="roiMultiple" class="text-3xl font-semibold accent-dark"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script>
            const METRICS = {
                serviceCost: {
                    label: "Total Investment",
                    format: (value) => formatCurrency(value)
                },
                emails: {
                    label: "Total Emails Sent",
                    format: (value) => value.toLocaleString()
                },
                replyRate: {
                    label: "Real Reply Rate",
                    format: (value) => `${value.toFixed(2)}%`
                },
                interestedRate: {
                    label: "Interested Reply Rate",
                    format: (value) => `${Math.round(value)}%`
                },
                bookingRate: {
                    label: "Lead-to-Booking Rate",
                    format: (value) => `${Math.round(value)}%`
                },
                showRate: {
                    label: "Meeting Show Rate",
                    format: (value) => `${Math.round(value)}%`
                },
                closeRate: {
                    label: "Close Rate",
                    format: (value) => `${Math.round(value)}%`
                },
                dealSize: {
                    label: "Average Deal Size",
                    format: (value) => formatCurrency(value)
                }
            };

            const SBM_PRESET = {
                serviceCost: { default: 15000, min: 0, max: 25000, step: 500 },
                emails: { default: 100000, min: 0, max: 1000000, step: 10000 },
                replyRate: { default: 0.75, min: 0, max: 5, step: 0.05 },
                interestedRate: { default: 15, min: 0, max: 100, step: 1 },
                bookingRate: { default: 50, min: 0, max: 100, step: 1 },
                showRate: { default: 80, min: 0, max: 100, step: 1 },
                closeRate: { default: 25, min: 0, max: 100, step: 1 },
                dealSize: { default: 250000, min: 0, max: 1000000, step: 10000 }
            };

            const ENTERPRISE_PRESET = {
                serviceCost: { default: 25000, min: 0, max: 50000, step: 1000 },
                emails: { default: 250000, min: 0, max: 1000000, step: 25000 },
                replyRate: { default: 1, min: 0, max: 5, step: 0.05 },
                interestedRate: { default: 20, min: 0, max: 100, step: 1 },
                bookingRate: { default: 60, min: 0, max: 100, step: 1 },
                showRate: { default: 85, min: 0, max: 100, step: 1 },
                closeRate: { default: 30, min: 0, max: 100, step: 1 },
                dealSize: { default: 500000, min: 0, max: 10000000, step: 50000 }
            };

            function formatCurrency(value) {
                return new Intl.NumberFormat("en-US", {
                    style: "currency",
                    currency: "USD",
                    maximumFractionDigits: 0
                }).format(value);
            }

            function roundHundreds(value) {
                return Math.round(value / 100) * 100;
            }

            const elements = {};
            const numberInputs = {};
            const metricBlocks = document.querySelectorAll("[data-metric]");

            metricBlocks.forEach((block) => {
                const key = block.dataset.metric;
                const config = METRICS[key];
                if (!config) return;

                const labelEl = block.querySelector("[data-metric-label]");
                const inputEl = block.querySelector("[data-metric-input]");
                const numberEl = block.querySelector("[data-metric-number]");

                if (labelEl) labelEl.textContent = config.label;
                if (inputEl) elements[key] = inputEl;
                if (numberEl) numberInputs[key] = numberEl;
            });

            const outputs = {
                replies: document.getElementById("replies"),
                interested: document.getElementById("interested"),
                bookings: document.getElementById("bookings"),
                shows: document.getElementById("shows"),
                closes: document.getElementById("closes"),
                revenue: document.getElementById("revenue"),
                netReturn: document.getElementById("netReturn"),
                roiMultiple: document.getElementById("roiMultiple")
            };

            const setRangeFill = (input) => {
                const min = Number(input.min);
                const max = Number(input.max);
                const val = Number(input.value);
                const pct = ((val - min) / (max - min)) * 100;
                input.style.background = `linear-gradient(90deg, #34d399 0%, #34d399 ${pct}%, #3f3f46 ${pct}%, #3f3f46 100%)`;
            };

            const setReadouts = () => {
                Object.keys(METRICS).forEach((key) => {
                    if (numberInputs[key]) {
                        numberInputs[key].value = state[key];
                        numberInputs[key].title = METRICS[key].format
                            ? METRICS[key].format(state[key])
                            : state[key];
                    }
                });
            };

            const calculate = () => {
                const replies = Math.round(state.emails * (state.replyRate / 100));
                const interested = Math.round(replies * (state.interestedRate / 100));
                const bookings = Math.round(interested * (state.bookingRate / 100));
                const shows = Math.round(bookings * (state.showRate / 100));
                const closes = Math.floor(shows * (state.closeRate / 100));
                const revenue = roundHundreds(closes * state.dealSize);
                const netReturn = roundHundreds(revenue - state.serviceCost);
                const roiMultiple = state.serviceCost === 0 ? 0 : revenue / state.serviceCost;

                outputs.replies.textContent = replies.toLocaleString();
                outputs.interested.textContent = interested.toLocaleString();
                outputs.bookings.textContent = bookings.toLocaleString();
                outputs.shows.textContent = shows.toLocaleString();
                outputs.closes.textContent = closes.toLocaleString();
                outputs.revenue.textContent = formatCurrency(revenue);
                outputs.netReturn.textContent = formatCurrency(netReturn);
                outputs.roiMultiple.textContent = `${roiMultiple.toFixed(1)}Ã—`;
            };

            const state = {};

            const applyPreset = (preset) => {
                Object.keys(METRICS).forEach((key) => {
                    const config = preset[key];
                    if (!config) return;
                    METRICS[key].min = config.min;
                    METRICS[key].max = config.max;
                    METRICS[key].step = config.step;
                    METRICS[key].default = config.default;

                    const rangeEl = elements[key];
                    const numberEl = numberInputs[key];
                    if (rangeEl) {
                        rangeEl.min = config.min;
                        rangeEl.max = config.max;
                        rangeEl.step = config.step;
                        rangeEl.value = config.default;
                        setRangeFill(rangeEl);
                    }
                    if (numberEl) {
                        numberEl.min = config.min;
                        numberEl.max = config.max;
                        numberEl.step = config.step;
                        numberEl.value = config.default;
                    }
                    state[key] = config.default;
                });

                setReadouts();
                calculate();
            };

            Object.keys(elements).forEach((key) => {
                const rangeEl = elements[key];
                const numberEl = numberInputs[key];

                rangeEl.addEventListener("input", (event) => {
                    state[key] = Number(event.target.value);
                    if (numberEl) {
                        numberEl.value = state[key];
                    }
                    setRangeFill(event.target);
                    setReadouts();
                    calculate();
                });

                if (numberEl) {
                    numberEl.addEventListener("input", (event) => {
                        state[key] = Number(event.target.value);
                        rangeEl.value = event.target.value;
                        setRangeFill(rangeEl);
                        setReadouts();
                        calculate();
                    });
                }
            });

            applyPreset(SBM_PRESET);

            const presetButtons = document.querySelectorAll("[data-preset]");
            const setActivePresetButton = (activeButton) => {
                presetButtons.forEach((btn) => {
                    btn.classList.toggle("border-emerald-400/60", btn === activeButton);
                    btn.classList.toggle("text-emerald-200", btn === activeButton);
                });
            };

            presetButtons.forEach((button) => {
                button.addEventListener("click", () => {
                    const preset = button.dataset.preset === "enterprise" ? ENTERPRISE_PRESET : SBM_PRESET;
                    applyPreset(preset);
                    setActivePresetButton(button);
                });
            });

            if (presetButtons.length > 0) {
                setActivePresetButton(presetButtons[0]);
            }

            const exportButton = document.getElementById("exportPdf");
            exportButton.addEventListener("click", async () => {
                const { jsPDF } = window.jspdf;

                const root = document.documentElement;
                const exportArea = document.getElementById("exportArea");
                const isLight = document.body.classList.contains("light");
                const backgroundColor = isLight ? "#ffffff" : "#0b0b0c";

                const themeToggle = document.getElementById("themeToggle");
                const exportPdf = document.getElementById("exportPdf");
                const presetToggles = document.querySelectorAll("[data-preset]");
                const prevThemeDisplay = themeToggle.style.display;
                const prevExportDisplay = exportPdf.style.display;
                const prevPresetDisplays = Array.from(presetToggles).map((btn) => btn.style.display);
                const prevOverflow = root.style.overflow;
                root.style.overflow = "visible";
                document.body.classList.add("exporting");
                themeToggle.style.display = "none";
                exportPdf.style.display = "none";
                presetToggles.forEach((btn) => {
                    btn.style.display = "none";
                });

                const canvas = await html2canvas(exportArea, {
                    backgroundColor,
                    scale: 2,
                    scrollX: 0,
                    scrollY: 0,
                    windowWidth: exportArea.scrollWidth,
                    windowHeight: exportArea.scrollHeight,
                });

                themeToggle.style.display = prevThemeDisplay;
                exportPdf.style.display = prevExportDisplay;
                presetToggles.forEach((btn, index) => {
                    btn.style.display = prevPresetDisplays[index];
                });
                document.body.classList.remove("exporting");
                root.style.overflow = prevOverflow;

                const pdf = new jsPDF("p", "pt", "a4");
                const pageWidth = pdf.internal.pageSize.getWidth();
                const imgWidth = pageWidth;
                const imgHeight = canvas.height * pageWidth / canvas.width;
                pdf.addImage(canvas.toDataURL("image/png"), "PNG", 0, 0, imgWidth, imgHeight);

                pdf.save("roi-calculator.pdf");
            });

            const themeToggle = document.getElementById("themeToggle");
            themeToggle.addEventListener("click", () => {
                document.body.classList.toggle("light");
            });
        </script>
</body>

</html>